function MapInputWidgetManager(){const b=".kolyunya-map-input-widget";var a=this;var c=Array();var e=function(f){if(!$(f).data("initialized")){var g=new MapInputWidget(f);g.initialize();return g}return null};var d=function(g){var f=g.getId();c[f]=g};this.initializeWidgets=function(){$(b).each(function(f,g){var h=e(g);if(h){d(h)}})};this.getWidget=function(f){var g=c[f];return g}}function MapInputWidget(e){const o="input.kolyunya-map-input-widget-input";const b="div.kolyunya-map-input-widget-canvas";var k=this;var h;var c;var r;var p=function(){h=$(e).find(o).get(0);c=$(e).find(b).get(0)};var a=function(){r=new google.maps.Map(c,{mapTypeId:$(e).data("map-type"),center:q(),zoom:$(e).data("zoom"),styles:[{featureType:"poi",stylers:[{visibility:"off",},],},],mapTypeControlOptions:{mapTypeIds:[],},});google.maps.event.addListener(r,"click",function(s){k.setPosition({latitude:s.latLng.lat(),longitude:s.latLng.lng(),})})};var l=function(){var s=(document.getElementById(k.getId()+"-pac-input"));r.controls[google.maps.ControlPosition.TOP_LEFT].push(s);var t=new google.maps.places.SearchBox((s));google.maps.event.addListener(t,"places_changed",function(){var w=t.getPlaces();var z=[];if(w.length==0){return}for(var x=0,v;v=z[x];x++){v.setMap(null)}z=[];var y=new google.maps.LatLngBounds();for(var x=0,u;u=w[x];x++){k.setPosition(u.geometry.location);y.extend(u.geometry.location)}google.maps.event.addListenerOnce(r,"bounds_changed",function(){r.setZoom(Math.min(15,r.getZoom()))});r.fitBounds(y)});google.maps.event.addListener(r,"bounds_changed",function(){var u=r.getBounds();t.setBounds(u)});google.maps.event.addDomListener(s,"keydown",function(u){if(u.keyCode==13){u.preventDefault()}})};var g=function(){var s=d();k.setPosition(s);$(e).data("initialized",true)};var f=function(t){var u=i();var s=m(t);u=u.replace(/%latitude%/g,s.lat());u=u.replace(/%longitude%/g,s.lng());return u};var j=function(){var s=$(h).prop("value")!="";return s};var d=function(){var B;var x=i();var z=$(h).prop("value");if(z!==""){var v=x.indexOf("%latitude%");var y=x.indexOf("%longitude%");var t=v<y;var u=t?0:1;var w=t?1:0;var A=z.match(/-?\d+(\.\d+)?/g)[u];var s=z.match(/-?\d+(\.\d+)?/g)[w];B=new google.maps.LatLng(A,s)}else{B=null}return B};var n=function(){var u=$(e).data("latitude");var t=$(e).data("longitude");var s=new google.maps.LatLng(u,t);return s};var q=function(){var s;if(j()){s=d()}else{s=n()}return s};var i=function(){var s=$(e).data("pattern");return s};var m=function(t){var s;if(t.latitude!==undefined&&t.longitude!==undefined){var v=t.latitude;var u=t.longitude;s=new google.maps.LatLng(v,u)}else{s=t}return s};this.initialize=function(){p();a();l();g()};this.getId=function(){var s=$(e).prop("id");return s};this.setPosition=function(t){if(r.marker){r.marker.setMap(null)}if(t===null){$(h).prop("disabled",true);return}else{$(h).prop("disabled",false)}var s=m(t);if($(e).data("align-map-center")===1){r.panTo(s)}var v=null;if($(e).data("animate-marker")===1){v=google.maps.Animation.DROP}r.marker=new google.maps.Marker({map:r,position:s,draggable:true,animation:v,});google.maps.event.addListener(r.marker,"dragend",function(){k.setPosition(this.getPosition())});var u=$(e).data("pattern");var w=f(s);$(h).prop("value",w)};this.panTo=function(t){var s=m(t);r.panTo(s)};this.setZoom=function(s){r.setZoom(s)}}var mapInputWidgetManager;$(window).load(function(){mapInputWidgetManager=new MapInputWidgetManager();mapInputWidgetManager.initializeWidgets()});